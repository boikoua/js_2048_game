const e=new class{constructor(e){this.board=e||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle",this.size=this.board.length,this.addRandomTile(),this.addRandomTile()}addRandomTile(){let e=[];for(let t=0;t<this.size;t++)for(let s=0;s<this.size;s++)0===this.board[t][s]&&e.push({row:t,col:s});if(e.length>0){let{row:t,col:s}=e[Math.floor(Math.random()*e.length)];this.board[t][s]=.9>Math.random()?2:4}}moveLeft(){let e=!1;for(let t=0;t<this.size;t++){let s=this.board[t].filter(e=>e);for(let e=0;e<s.length-1;e++)s[e]===s[e+1]&&(s[e]*=2,this.score+=s[e],s.splice(e+1,1));for(;s.length<this.size;)s.push(0);this.board[t].every((e,t)=>e===s[t])||(this.board[t]=s,e=!0),e&&(this.addRandomTile(),this.checkGameOver())}}moveRight(){let e=!1;for(let t=0;t<this.size;t++){let s=this.board[t].filter(e=>e).reverse();for(let e=0;e<s.length-1;e++)s[e]===s[e+1]&&(s[e]*=2,this.score+=s[e],s.splice(e+1,1));for(;s.length<this.size;)s.push(0);s.reverse(),this.board[t].every((e,t)=>e===s[t])||(this.board[t]=s,e=!0)}e&&(this.addRandomTile(),this.checkGameOver())}moveUp(){let e=!1;for(let t=0;t<this.size;t++){let s=[];for(let e=0;e<this.size;e++)0!==this.board[e][t]&&s.push(this.board[e][t]);for(let e=0;e<s.length-1;e++)s[e]===s[e+1]&&(s[e]*=2,this.score+=s[e],s.splice(e+1,1));for(;s.length<this.size;)s.push(0);for(let i=0;i<this.size;i++)this.board[i][t]!==s[i]&&(this.board[i][t]=s[i],e=!0)}e&&(this.addRandomTile(),this.checkGameOver())}moveDown(){let e=!1;for(let t=0;t<this.size;t++){let s=[];for(let e=3;e>=0;e--)0!==this.board[e][t]&&s.push(this.board[e][t]);for(let e=0;e<s.length-1;e++)s[e]===s[e+1]&&(s[e]*=2,this.score+=s[e],s.splice(e+1,1));for(;s.length<this.size;)s.push(0);s.reverse();for(let i=0;i<this.size;i++)this.board[i][t]!==s[i]&&(this.board[i][t]=s[i],e=!0)}e&&(this.addRandomTile(),this.checkGameOver())}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.status="playing",this.score=0,this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.addRandomTile(),this.addRandomTile()}restart(){return this.start()}checkGameOver(){for(let e=0;e<this.size;e++)for(let t=0;t<this.size;t++)if(0===this.board[e][t]||t<3&&this.board[e][t]===this.board[e][t+1]||e<3&&this.board[e][t]===this.board[e+1][t])return;this.status="lose"}},t=document.querySelector(".start"),s=document.querySelector(".message-start"),i=document.querySelector(".message-win"),r=document.querySelector(".message-lose");function o(){let t=e.getState(),o=e.getScore(),a=e.getStatus();document.querySelector(".game-score").textContent=o;for(let e=0;e<4;e++)for(let s=0;s<4;s++){let i=document.querySelector(`.field-row:nth-child(${e+1}) .field-cell:nth-child(${s+1})`);i.textContent=0===t[e][s]?"":t[e][s],i.className=`field-cell field-cell--${t[e][s]}`}"playing"===a?s.classList.add("hidden"):"win"===a?(i.classList.remove("hidden"),document.querySelector(".restart").addEventListener("click",()=>{i.classList.add("hidden")})):"lose"===a?(r.classList.remove("hidden"),document.querySelector(".restart").addEventListener("click",()=>{r.classList.add("hidden")})):(i.classList.add("hidden"),r.classList.add("hidden"))}t.addEventListener("click",()=>{e.start(),o(),t.textContent="Restart",t.classList.add("restart"),t.classList.remove("start")}),document.addEventListener("keydown",t=>{if("playing"===e.getStatus()){switch(t.key){case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown()}o()}});
//# sourceMappingURL=index.265406a9.js.map
